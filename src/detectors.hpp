#ifndef DETECTORS_HPP
#define DETECTORS_HPP

#include "physics.hpp"
#include "branches.hpp"
#include "TVector.h"
#include "constants.hpp"


const static int _num_cc_segments_ = 18;


namespace detect{
	//float Acc = -0.000785;
	//float Bcc = 0.0;
	//float Ccc = -0.00168;
	//float Dcc = 1.0;
//CC functions
	int cc_segment(int cc_segm);
	int cc_lrc(int cc_segm);
	TVector3 cc_sector_center(TVector3 v_);
	TVector3 cc_sector_center(float x_, float y_, float z_);
	float cc_theta(float cx_sc_, float cy_sc_, float cz_sc_, float x_sc_, float y_sc_, float z_sc_);
	float cc_theta(std::shared_ptr<Branches> data_, int idx_);
	float cc_phi(float cx_sc_, float cy_sc_, float cz_sc_, float x_sc_, float y_sc_, float z_sc_);
	float cc_phi(std::shared_ptr<Branches> data_, int idx_);
	float cc_x(float cx_sc_, float cy_sc_, float cz_sc_, float x_sc_, float y_sc_, float z_sc_, int sec_);
	float cc_y(float cx_sc_, float cy_sc_, float cz_sc_, float x_sc_, float y_sc_, float z_sc_, int sec_);
	float cc_x(std::shared_ptr<Branches> data_, int idx_);
	float cc_y(std::shared_ptr<Branches> data_, int idx_);
	float cc_eff(int run_, int sec_, int seg_, int pos_);

	//SC functions
	float sc_theta(std::shared_ptr<Branches> data_, int idx_);
	float sc_phi(std::shared_ptr<Branches> data_, int idx_);

	//EC functions
	float ec_theta(std::shared_ptr<Branches> data_, int idx_);
	float ec_phi(std::shared_ptr<Branches> data_, int idx_);

	//CC Efficiencies [e16,e1f][Sector][Segment][left,coincidence,right] //E16 done on 8-15-23. Could have more tweaking on edges
		static const float cc_eff_vals[2][6][18][3] = {{	{	{ 0.4294142333753131,1.0,0.7498258687360017 },
																{ 0.8945576722297547,0.9735945359360575,0.7397280080552094 },
																{ 0.9787466004223233,0.9995135778819804,0.9812836083627156 },
																{ 0.9642876143669963,0.9970700815477905,0.9771166453518502 },
																{ 0.9769722196446295,0.9802291539982217,0.9815511285222746 },
																{ 0.986216476957671,0.9948918664520281,0.9697894683756108 },
																{ 0.9881539910311787,0.7879386225632322,0.9718748326091847 },
																{ 0.9921649760765079,0.9709522401588637,0.9875617568721046 },
																{ 0.989456139903923,0.9739889858554508,0.9887960676829277 },
																{ 0.9903641113282655,0.9537615939496479,0.9828164145040883 },
																{ 0.9859104035271676,0.9344645285165236,0.9642410041180214 },
																{ 0.9849289266158094,0.9305869937930699,0.9747552687095675 },
																{ 0.9894620634550036,0.8959183802062068,0.9839991320091462 },
																{ 0.9887660317777501,0.9231822351688264,0.972764027482389 },
																{ 0.9668986029963053,0.9318097170892713,0.9819266700916914 },
																{ 0.9781554181760864,0.8743794558378112,0.9714742546371525 },
																{ 0.9435235956600072,1.0,0.9421842954922669 },
																{ 0.771089551058667,1.0,0.7390026621092807 }},
															{	{ 0.6582714369567099,0.828514236134431,0.6974566873314525 },
																{ 0.8545422422410711,0.971956787415847,1.0 },
																{ 0.9692026432282218,0.998114928964341,0.9651703824380755 },
																{ 0.9128094052859308,0.7219331414589546,0.9542446913308764 },
																{ 0.9315247781948016,0.8783883805131921,0.9393727354062655 },
																{ 0.9711806921578132,0.9790834754798486,0.98266698862985 },
																{ 0.9320202743035747,0.9467833317024077,0.9780390572575554 },
																{ 0.9855459819172175,0.944425641046958,0.9790163406383529 },
																{ 0.9770923348232241,0.8996385976117971,0.9866164549713051 },
																{ 0.9656146955239622,0.8800513722748842,0.9753886391910053 },
																{ 0.9622703971760819,0.6933965409904802,0.983106612038566 },
																{ 0.9768183933728593,0.8551886756447094,0.9867366444702534 },
																{ 0.9845959386517229,0.8862760646545238,0.972970484506833 },
																{ 0.9902751831801155,0.7809801669717185,0.9611410696551848 },
																{ 0.9856499012294976,0.6981954745873291,0.9690768557073951 },
																{ 0.9601190730527653,0.8765360694036198,0.9507717694915019 },
																{ 0.9440327279330195,1.0,0.8745395966369776 },
																{ 0.7449892665033968,1.0,0.9602197333806327 }},
															{	{ 0.6691074105865237,1.0,0.4692085602235395 },
																{ 0.7062186700113019,0.8913765947906191,0.6767523077627676 },
																{ 0.9928180497291345,0.9957181988913542,0.9951293761016529 },
																{ 0.9733753848915702,0.9979478329817455,0.9858167989373742 },
																{ 0.9847934396312078,0.9946782783225477,0.9878357400565101 },
																{ 0.9873588813728427,0.9888761869782094,0.986726728650973 },
																{ 0.9716732561598069,0.950001110371923,0.9844274735438588 },
																{ 0.9828037415386663,0.9651823263618301,0.9891303763571727 },
																{ 0.9921501994840359,0.9573678005810536,0.9864859191222639 },
																{ 0.9891448885974281,0.961644815043796,0.9850601206431282 },
																{ 0.991767189597437,0.9339798305260062,0.9824777206712655 },
																{ 0.9823961787307346,0.7135137133671554,0.9892921536449143 },
																{ 0.9815362683472387,0.9223058715353036,0.9886893534837475 },
																{ 0.9793481049634192,0.9320277249754176,0.982638143368533 },
																{ 0.988985471503625,0.9122990704280687,0.9903732555232454 },
																{ 0.9810921117813624,0.598078218832506,0.9916426387855451 },
																{ 0.8803930057742142,1.0,0.9296504698617396 },
																{ 0.7883797730259796,1.0,0.7777119687355453 }},
															{	{ 0.536562033544337,1.0,0.6027179871637619 },
																{ 0.86553522532653,0.9554798283383489,0.9111289871910311 },
																{ 0.9825033720746623,0.9992477325955337,0.9649878057109862 },
																{ 0.9720038989835763,0.9974986012371193,0.9668934669381283 },
																{ 0.9643299206600223,0.8961585683369496,0.9463588732591641 },
																{ 0.9270345344456802,0.9716081153159091,0.9645454614855573 },
																{ 0.9768171937973091,0.6674715626368285,0.977889101667648 },
																{ 0.9864448405614704,0.9928529475035531,0.9844690176251637 },
																{ 0.9852204025119337,0.9839319151278274,0.9917053495670282 },
																{ 0.9805791832026004,0.9206334676068387,0.9816550270562501 },
																{ 0.9474389341903785,0.8672216485090521,0.9435918360194897 },
																{ 0.9768212161733162,0.8968718047116699,0.960540340894844 },
																{ 0.9846982481991152,0.8465352446135377,0.9770571142098566 },
																{ 0.9817375249914525,0.8871357224814438,0.986307103258117 },
																{ 0.9896856235372692,0.9309375732738939,0.9750439104702452 },
																{ 0.9748087219980959,0.9539383918159046,0.9694559733579594 },
																{ 0.9547313995205551,1.0,0.9541025806730586 },
																{ 0.6151851138551311,1.0,0.6974947959177445 }},
															{	{ 0.6653145942336403,0.838990874205219,0.7050515465397379 },
																{ 0.5670705591539635,0.8234642240682614,0.7276898540116551 },
																{ 0.9839568857652276,0.9792155259207707,0.8481046382122989 },
																{ 0.9891177809889545,0.9459408257911452,0.9857116090296247 },
																{ 0.9898363925167912,0.9619126665163569,0.9764196961734404 },
																{ 0.9766616887301129,0.9646690535622744,0.9794756168872735 },
																{ 0.9849234720684403,0.9670531529381894,0.9967047557544686 },
																{ 0.984755272643717,0.935985813373514,0.9872500042391664 },
																{ 0.978194306685887,0.9706888978521409,0.984052677878203 },
																{ 0.9909531783455939,0.9739276536271128,0.9890633013466577 },
																{ 0.9780987813676133,0.9285052834254565,0.9920400001576689 },
																{ 0.9686226278021393,0.9708182280567872,0.9885006578586077 },
																{ 0.9794832767858116,0.9643749083119161,0.9884974239997538 },
																{ 0.9789422791187508,0.9222705455284866,0.9786293257803252 },
																{ 0.9809939857385941,0.9318398335931192,0.9867471439120167 },
																{ 0.9386229296804907,0.812068925978435,0.9839120854771808 },
																{ 0.8921638122005903,1.0,0.9398698329824569 },
																{ 0.8189000916619648,1.0,0.8886494434029107 }},
															{	{ 0.5062847850645883,0.7595096031808042,0.7052475411318911 },
																{ 0.7512998287568893,0.9544982348108245,0.5719802975389121 },
																{ 0.9858667972598462,1.0,0.9646952663696329 },
																{ 0.9880058039110761,0.9915406176472574,0.981899080968096 },
																{ 0.9719940228920305,0.9786248201588448,0.9843412622990525 },
																{ 0.8620752989877156,0.9269851254123695,0.9659006010845876 },
																{ 0.9866184933397596,0.9679114186642604,0.9896724428602061 },
																{ 0.9940711462643977,0.9730421938012539,0.9931862675715015 },
																{ 0.9932615997564997,0.9626589413793413,0.9938251010965967 },
																{ 0.9830162966980169,0.930283202916911,0.9877829387021697 },
																{ 0.9832750931631655,0.8910063268656934,0.982179992677965 },
																{ 0.982073455359168,0.8999876324811007,0.973788151083275 },
																{ 0.9947927763446271,0.9520402174226515,0.962612295747398 },
																{ 0.9764861746923965,0.8902075715986193,0.9605514329327669 },
																{ 0.9872889213892654,0.8417528584345014,0.9972270270377029 },
																{ 0.9738065514508434,0.914340730612778,0.9717635986053607 },
																{ 0.9397387072305257,1.0,0.8902722816821782 },
																{ 0.632878120785325,1.0,1.0 }}},
														{	{	{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0}},
															{	{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0}},
															{	{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0}},
															{	{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0}},
															{	{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0}},
															{	{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0},{1.0,1.0,1.0}}}};
}



#endif